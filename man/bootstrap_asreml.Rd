% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/confint.R
\name{bootstrap_asreml}
\alias{bootstrap_asreml}
\title{Parametric bootstrap for an asreml model.}
\usage{
bootstrap_asreml(model, FUN, nsim = 1, use.u = FALSE, seed = NULL, ...)
}
\arguments{
\item{model}{An \code{asreml} fitted model. Must be fitted with \code{model.frame = TRUE}.}

\item{FUN}{A function with signature \verb{function(fit)} returning a scalar
(the statistic to bootstrap).}

\item{nsim}{Integer. Number of bootstrap replicates.}

\item{use.u}{A logical indicating whether to resample random effects, or only
resample residuals.}

\item{seed}{Optional integer seed for reproducibility.}

\item{...}{Additional arguments passed to \code{\link[boot:boot]{boot::boot()}}.}
}
\value{
A \code{boot} object.
}
\description{
Simulate \eqn{\hat{y} \sim N(X\hat{\beta}, V)} according to the current asreml fit
and then refit to obtain the targeted statistics.
}
\details{
Fits parametric bootstrap replicates for an \code{asreml} model by:
\itemize{
\item Extracting the fixed-effect fit yhat = X * beta.
\item Extracting V = Var(y) on the observation scale,
\item Simulating new responses y* = yhat + L \%*\% z where L is a Cholesky factor of V,
\item Refitting the same asreml call on each simulated dataset,
\item Returning a \code{boot} object.
}
}
\examples{
\dontrun{
  lettuce_subset <- lettuce_phenotypes |> subset(loc == "L2")
  lettuce_asreml <- asreml(
    fixed = y ~ rep * pseudo_var1,
    random = ~gen,
    sparse = ~pseudo_var2,
    data = lettuce_subset,
    trace = FALSE
  )

  b <- bootstrap_asreml(
    lettuce_asreml,
    R = 200,
    statistic = function(fit) coef(fit)$fixed["(Intercept)", "effect"],
    seed = 1
  )
  boot::boot.ci(b, type = "perc")
 }
}
